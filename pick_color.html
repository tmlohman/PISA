<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
  
    <script type="text/javascript">  
    
	function func(data) {
		data.map(function (d) {
				d.math_avg = +d.math_avg;
				d.reading_avg = +d.reading_avg;
				d.science_avg = +d.science_avg;
		})
		
		
		var colors = ["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"];		
		var score_extent = d3.extent(data, function(d) {
				return d.math_avg;
			});
			
		var score_scale = d3.scale.quantile()
						   .domain(score_extent)
						   .range(colors);
				
		var color_assignments = {};
		
		var l = data.length;
		for (var i = 0; i < l; i++) {
			color_assignments[data[i].country] = score_scale(data[i].math_avg);
		}
		
		return color_assignments
		
	}


	d3.csv("avg_scores_by_country_complete2.csv", func)
    
    
    </script>
</body>
</html>
